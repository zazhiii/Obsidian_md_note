# 什么是线程和进程？
进程：进程是程序的一次执行过程，是系统运行程序的基本单位
线程：线程是比进程更小的执行单位，一个进程中可以产生多个线程

---

Java 线程和操作系统线程的关系？
现在Java的线程本质就是操作系统的线程。

---

# 线程和进程的关系、区别、优缺点？
一个进程中有多个线程，这些线程共享进程的**堆**和**方法区**。
每个线程有自己的**程序计数器、本地方法栈、虚拟机栈**
线程是进程划分成的更小的运行单位。
最大的不同是：进程是独立的，线程可能互相影响。线程执行开销小，但不利于资源保护。进程反之

程序计数器：用于记录线程执行的位置，确保切换回来时能知道上一次执行到哪里了。
虚拟机栈

堆：存储对象的内存
方法区：存储类信息、常量、静态变量等。

---

创建线程的方式？
继承 Thread 类、实现 Runnable 接口、实现Callable 接口、使用线程池……

---

# 线程的生命周期和状态
NEW 初始状态
RUNNABLE 运行状态
BLOCKED 阻塞状态
WATING 等待状态
TIME_WATING 超时等待

# 为什么要使用多线程？

主要目的是为了**提高并发性**、**提升效率**和**响应性**，提高程序的效率和响应性

对于单核 cpu ，如果不使用多线程，若线程被I/O阻塞，cpu 就只能等待；若使用多线程出现这种情况，cpu 可以切换到其他线程继续处理任务。提高了 cpu 使用率。
对于多核cpu，如果不使用多线程，只会有一个核心处理任务。若使用多线程，就可以让多个核心同时处理任务。这样执行效率会大大提高。

# 单核 CPU 支持多线程吗？

支持。
操作系统通过时间片轮转的方式，将 CPU 分配给不同的线程。（ CPU 在不同线程之间快速切换）

Java 线程的调度使用的是：抢占式调度
JVM 将线程的调度委托给操作系统，操作系统基于线程优先级和时间片来调度线程的执行

# 单核 CPU 运行多线程 效率一定会更高吗？

不一定。得看任务的性质。

**CPU 密集型**：单核 CPU 只能运行一个线程，多线程会导致线程间切换，增加系统开销，**降低效率**
**I/O 密集型**：CPU 在等待线程 I/O的时候可以切换到其他线程处理任务，**提高效率**

# 死锁
## 什么是死锁？

两个或者多个线程在执行过程中因为竞争资源而导致的**永久性阻塞**。线程互相等待对方释放所需要的资源，由于资源被互相占用，导致线程永远不能继续执行。

产生死锁的四个条件：
1. 互斥条件：资源只能被一个线程所占有
2. 请求与保持条件：线程在请求资源而被阻塞的时候，保持资源不放。
3. 不可剥夺条件：线程在使用完资源时，不能被其他线程剥夺
4. 循环等待条件：若干线程线程一种头尾相连的等待资源关系


# ============

# JMM(Java Memory Model)

Java 内存模型

Java 没有复用操作系统的内存模型，而是自己提供一套内存模型屏蔽了系统差异性（跨平台）

JMM 可以看作 Java 并发编程的一种规范。他规定了**线程和主内存的关系**、规定 Java 从源代码到 CPU 指令需要遵守的规则。目的是为了避免 CPU 的某些设计导致 Java 多线程执行出现问题 。